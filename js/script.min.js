window.onload=function(){const e=document.querySelector("#form");if(e){function t(e){e.classList.remove("error"),e.parentElement.classList.remove("error")}function n(e){e.classList.add("error"),e.parentElement.classList.add("error")}function r(e){return!/^\w+([\.*]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,8})+$/.test(e.value)}e.addEventListener("submit",(async function(a){let o=function(e){let s=0;const i=document.querySelectorAll(".req");if(i.length){for(let e=0;e<i.length;e++){const a=i[e];t(a),a.classList.contains("email")?r(a)&&(n(a),s++):(a.classList.contains("req_checkbox")&&!1===a.checked||""===a.value)&&(n(a),s++)}return s}}(),l=new l(e);if(l.append("image",s.files[0]),0===o){e.classList.add("sending");let t=await fetch("sendmail.php",{method:"POST",body:l});if(t.ok){let n=await t.json();alert(n.message),i.innerHTML="",e.reset(),e.classList.remove("sending")}else alert("Ошибка"),e.classList.remove("sending")}else alert("Заполните обязательные поля");a.preventDefault()}));const s=document.getElementById("formImage"),i=document.getElementById("formImagePreview");s&&i&&s.addEventListener("change",(function(){!function(e){if(!["image/jpeg","image/png","image/gif"].includes(e.type))return alert("Разрешены только изображения."),void(s.value="");if(e.size>2097152)return void alert("Файл не может быть более 2 Mb.");var t=new FileReader;t.onload=function(e){i.innerHTML=`<img src="${e.target.result}" alt="ваше фото">`},t.onerror=function(e){alert("Ошибка")},t.readAsDataURL(e)}(s.files[0])}))}};